<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather</title>
    <!-- Google fonts link -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <!-- FontAwesome link -->
    <script src="https://use.fontawesome.com/4ecfe909f1.js"></script>
    <link rel="icon" type="image/x-icon" href="cloud-sun-solid.svg">
    <!-- CSS link -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="wrap">
    <div class="card__weather" id="card__weather">
        <div class="name">
            <p class="city_name" id="city_name"></p>
            <p class="country" id="country"></p>
        </div>
        <div id="res" class="res"></div>
    <div class="table">
        <div class="row">
            <div class="temp_max">max temperature:<p id="temp_max"></p></div>
            <div class="temp_min">min temperature:<p id="temp_min"></p></div>
        </div>
        <div class="row">
            <div class="feels_like">feels like: <p id="feels_like"></p></div>
            <div class="humidity">humidity: <p id="humidity"></p></div>
        </div>
        <div class="row1">
            <div class="clouds">cloudliness: <p id="clouds"></p></div>
            <div class="pressure">wind speed: <p id="ws"></p> </div>
        </div>
    </div>
    </div>
   
    <div class="card" id="card">
    <div class="ico">
        <div class="icon"></div>
    </div>
    <input type="text" id="cityField" placeholder="Type your city">
    <button id="check">Search </button>
   </div>
   <div class="warnmessage" id="warnmessage">Type your city, please.</div>
   <div class="locmessage" id="locmessage">
    <p> Is     <div class="geoloc" id="geoloc">     </div> your location?</p>
    <div class="buttons">
        <div id="yesbutton" class="btnchoose">Yes</div>
        <div id="nobutton" class="btnchoose">No</div>
    </div>
    </div>
</div>

    <script>
    const key ='f478ddd15a0691bbee4394a2de255833';
    let city=cityField.value;
    
    fetch('https://api.freegeoip.app/json/?apikey=6719b7a0-b686-11ec-8094-a3b1bae48427' + city  )
                    .then(res => {
                        return res.json();
                    })
                    .then(data => {
                        console.log(data)
                        let gL=(data.city);
                        geoloc.innerText=gL;
                        locmessage.style.top="10%";
                        yesbutton.onclick=function(){
                            cityField.value=(data.city); 
                            locmessage.style.top='-20%';
                            if(cityField.value!=city&&cityField.value!=' '){
            let city=cityField.value;
    fetch('http://api.openweathermap.org/data/2.5/weather?q='+city+'&appid='+key)
.then(response =>{
    return (response.json())
})
.then(data=>{
    let t=(data.main.temp-273).toFixed(2);
    let tMax=(data.main.temp_max-273).toFixed(2);
    let tMin=(data.main.temp_min-273).toFixed(2);
    let cName=(data.name);
    let fLike=(data.main.feels_like-273).toFixed(2);
    let hM=(data.main.humidity);
    let cL=(data.clouds.all);
    let wS=(data.wind.speed);
    let cN=(data.sys.country);
    console.log(data);
    res.innerText=t+'°C';
    cityField.value="";
    temp_max.innerText=tMax+'°C';
    temp_min.innerText=tMin+'°C';
    city_name.innerText=cName+',';
    feels_like.innerText=fLike+'°C';
    humidity.innerText=hM+'%';
    clouds.innerText=cL+'%';
    ws.innerText=wS;
    country.innerText=cN;
    
})           
    card.style.left="70%";
    card__weather.style.left="0";
}
  }
    nobutton.onclick=function(){
    locmessage.style.top = '-20%';
    warnmessage.style.top="10%";
setTimeout(function(){
    warnmessage.style.transition = '.3s';
            warnmessage.style.top = '-20%';
        },2000);
    } 
                    })
                    
    check.onclick=function(){ 
        if(cityField.value!=city&&cityField.value!=' '){
            let city=cityField.value;
    fetch('http://api.openweathermap.org/data/2.5/weather?q='+city+'&appid='+key)
.then(response =>{
    return (response.json())
})
.then(data=>{
    let t=(data.main.temp-273).toFixed(2);
    let tMax=(data.main.temp_max-273).toFixed(2);
    let tMin=(data.main.temp_min-273).toFixed(2);
    let cName=(data.name);
    let fLike=(data.main.feels_like-273).toFixed(2);
    let hM=(data.main.humidity);
    let cL=(data.clouds.all);
    let wS=(data.wind.speed);
    let cN=(data.sys.country);
    console.log(data);
    res.innerText=t+'°C';
    cityField.value="";
    temp_max.innerText=tMax+'°C';
    temp_min.innerText=tMin+'°C';
    city_name.innerText=cName+',';
    feels_like.innerText=fLike+'°C';
    humidity.innerText=hM+'%';
    clouds.innerText=cL+'%';
    ws.innerText=wS;
    country.innerText=cN;

    

})           
    card.style.left="70%";
    card__weather.style.left="0";
}else{
   
warnmessage.style.top="10%";
setTimeout(function(){
    warnmessage.style.transition = '.3s';
            warnmessage.style.top = '-20%';
        },2000);

       
}

    }
    cityField.onkeydown=function(e){
        if(cityField.value!=city){
        if(e.keyCode===13){
            let city=cityField.value;
    fetch('http://api.openweathermap.org/data/2.5/weather?q='+city+'&appid='+key)
.then(response =>{
    return (response.json())
})
.then(data=>{
    let t=(data.main.temp-273).toFixed(2);
    let tMax=(data.main.temp_max-273).toFixed(2);
    let tMin=(data.main.temp_min-273).toFixed(2);
    let cName=(data.name);
    let fLike=(data.main.feels_like-273).toFixed(2);
    let hM=(data.main.humidity);
    let cL=(data.clouds.all);
    let wS=(data.wind.speed);
    let cN=(data.sys.country);
    console.log(data);
    res.innerText=t+'°C';
    cityField.value="";
    temp_max.innerText=tMax+'°C';
    temp_min.innerText=tMin+'°C';
    city_name.innerText=cName+',';
    feels_like.innerText=fLike+'°C';
    humidity.innerText=hM+'%';
    clouds.innerText=cL+'%';
    ws.innerText=wS;
    country.innerText=cN;
})
card.style.left="70%";
    card__weather.style.left="0";
        }
    }
       
        
    }

    </script>
</body>
</html>